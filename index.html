<html>
	<head>
		<link rel="stylesheet" type="text/css" href="static/main.css"/>
		<link rel="stylesheet" type="text/css" href="xTags/branding/xBranding.css"/>
		<link rel="stylesheet" type="text/css" href="lib/brick-0.9.2.min.css"/>

		<script type='text/javascript' src='lib/brick-0.9.2.min.js'></script>
		<script type='text/javascript' src='lib/dygraph-1.0.1.min.js'></script>
		<script type='text/javascript' src='xTags/branding/xBranding.js'></script>
		<script type='text/javascript' src='static/grif16.js'></script>
		<script type='text/javascript' src='static/mscb.js'></script>
	</head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

	<body>

		<div id='wrapper'>
			<branding-head experiment='GRIFFIN' subline='GRIF16ADC'></branding-head>

			<div id='mainContent'>
				<div id='nav'>
					<input id='swap0' name='view', onclick='cycleTo(0)' type='radio' checked></input>
					<label for='swap0'>ADC 0</label>
					<input id='swap1' name='view', onclick='cycleTo(1)' type='radio'></input>
					<label for='swap1'>ADC 1</label>
					<input id='swap2' name='view', onclick='cycleTo(2)' type='radio'></input>
					<label for='swap2'>ADC 2</label>
					<input id='swap3' name='view', onclick='cycleTo(3)' type='radio'></input>
					<label for='swap3'>ADC 3</label>
					<input id='swap4' name='view', onclick='cycleTo(4)' type='radio'></input>
					<label for='swap4'>ADC 4</label>
					<input id='swap5' name='view', onclick='cycleTo(5)' type='radio'></input>
					<label for='swap5'>ADC 5</label>
					<input id='swap6' name='view', onclick='cycleTo(6)' type='radio'></input>
					<label for='swap6'>ADC 6</label>
					<input id='swap7' name='view', onclick='cycleTo(7)' type='radio'></input>
					<label for='swap7'>ADC 7</label>
					<input id='swap8' name='view', onclick='cycleTo(8)' type='radio'></input>
					<label for='swap8'>ADC 8</label>
					<input id='swap9' name='view', onclick='cycleTo(9)' type='radio'></input>
					<label for='swap9'>ADC 9</label>
					<input id='swap10' name='view', onclick='cycleTo(10)' type='radio'></input>
					<label for='swap10'>ADC 10</label>
					<input id='swap11' name='view', onclick='cycleTo(11)' type='radio'></input>
					<label for='swap11'>ADC 11</label>
					<input id='swap12' name='view', onclick='cycleTo(12)' type='radio'></input>
					<label for='swap12'>ADC 12</label>
					<input id='swap13' name='view', onclick='cycleTo(13)' type='radio'></input>
					<label for='swap13'>ADC 13</label>
					<input id='swap14' name='view', onclick='cycleTo(14)' type='radio'></input>
					<label for='swap14'>ADC 14</label>
					<input id='swap15' name='view', onclick='cycleTo(15)' type='radio'></input>
					<label for='swap15'>ADC 15</label>


				</div>
				<div id='plotTarget'></div>

				<div id='control'>

					<div id='ADCstatusPane' class='collapse'>
						<h3 class='sectionHead' onclick='toggleSection.bind(this, "ADCstatusPane")()'>&#9654 MSCB Node Info</h3>

						<ul>
							<li id='ctrl'></li>
							<li id='rev'></li>
							<li id='serial'></li>
							<li id='cpu_temp'></li>
							<li id='cc_lock'></li>
							<li id='cc_freq'></li>
							<li id='hw_sw_m'></li>
							<li id='hw_id'></li>
							<li id='hw_time'></li>
							<li id='sw_id'></li>
							<li id='sw_time'></li>
							<li id='uptime'></li>
							<li id='dac_ch'></li>
							<li id='ref_clk'></li>
							<li id='ch_en'></li>
							<li id='ch_aa'></li>
						</ul>
					</div>

					<div id='ADC' class='collapse'>
						<h3 class='sectionHead' onclick='toggleSection.bind(this, "ADC")()'>&#9654 ADC Control</h3>
						<ul>
							<li>
								<p>DC Offset:</p>
								<input id='a_dcofst' type='range' step=1 min=0 max=4095 oninput='updateADC.bind(this)()'></input>
								<label id='dcofstLabel'>mV</label>
							</li>
							<li>
								<label>ADC Chan:</label>
								<input id='DCenable' type='radio' name='a_off' value=true checked onchange='updateADC.bind(this)()'></input>
								<label for='DCenable'>Enabled</label>
								<input id='DCdisable' type='radio' name='a_off' value=false onchange='updateADC.bind(this)()'></input>
								<label for='DCdisable'>Disabled</label>
							</li>
							<li>
								<label>Trim:</label>
								<input id='a_trim' type='number' step=1 oninput='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>Polarity:</label>
								<input id='posPol' type='radio' name='a_pol' value=true checked onchange='updateADC.bind(this)()'></input>
								<label for='posPol'>Positive</label>
								<input id='negPol' type='radio' name='a_pol' value=false onchange='updateADC.bind(this)()'></input>
								<label for='negPol'>Negative</label>
							</li>
						</ul>
					</div>

					<div id='trig' class='collapse'>
						<h3 class='sectionHead' onclick='toggleSection.bind(this, "trig")()'>&#9654 Triggering</h3>
						<ul>
							<li>
								<label>Channel:</label>
								<input id='chanEnable' type='radio' name='t_off' value=true checked onchange='updateADC.bind(this)()'></input>
								<label for='chanEnable'>Enabled</label>
								<input id='chanDisable' type='radio' name='t_off' value=false onchange='updateADC.bind(this)()'></input>
								<label for='chanDisable'>Disabled</label>
							</li>
							<li>
								<label>Hit Thresh:</label>
								<input id='t_hthres' type='number' step=any onchange='updateADC.bind(this)()'></input>
								<label>ADC units</label>
							</li>
							<li>
								<label>Trig Thresh:</label>
								<input id='t_thres' type='number' step=any onchange='updateADC.bind(this)()'></input>
								<label>ADC units</label>
							</li>
							<li>
								<label>Differentiation:</label>
								<input id='t_diff' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>Integration:</label>
								<input id='t_int' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>Delay:</label>
								<input id='t_delay' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>Pole Cxn:</label>
								<input id='t_polcor' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>BLR Control:</label>
								<input id='t_blrctl' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
						</ul>
					</div>

					<div id='pulseHeight' class='collapse'>
						<h3 class='sectionHead' onclick='toggleSection.bind(this, "pulseHeight")()'>&#9654 Pulse Height Evaluation</h3>
						<ul>
							<li>
								<label>Integration:</label>
								<input id='p_int' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>Differentiation:</label>
								<input id='p_diff' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>Delay:</label>
								<input id='p_delay' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>Pole Cxn 1:</label>
								<input id='p_polec1' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>Pole Cxn 2:</label>
								<input id='p_polec2' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>Baseline Rest.:</label>
								<input id='p_bsr' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>Gain:</label>
								<input id='p_gain' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label>keV/chan</label>
							</li>
							<li>
								<label>Pileup Algo:</label>
								<input id='p_pactrl' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>bitpattern</label>
							</li>
						</ul>
					</div>

					<div id='time' class='collapse'>
						<h3 class='sectionHead' onclick='toggleSection.bind(this, "time")()'>&#9654 Time Evaluation</h3>
						<ul>
							<li>
								<label>CFD Delay:</label>
								<input id='cfd_dly' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>CFD Fraction:</label>
								<input id='cfd_frac' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
						</ul>
					</div>

					<div id='waveform' class='collapse'>
						<h3 class='sectionHead' onclick='toggleSection.bind(this, "waveform")()'>&#9654 Waveform Readout</h3>
						<ul>
							<li>
								<input id='suppressedWF' type='radio' name='wfr_supp' value=true checked onchange='updateADC.bind(this)()'></input>
								<label for='suppressedWF'>Suppressed</label>
								<input id='unsuppressedWF' type='radio' name='wfr_supp' value=false onchange='updateADC.bind(this)()'></input>
								<label for='unsuppressedWF'>Unsuppressed</label>
							</li>
							<li>
								<label>Pretrigger:</label>
								<input id='wfr_pret' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>Samples:</label>
								<input id='wfr_smpl' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>Decimation:</label>
								<input id='wfr_dec' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>Filter WF:</label>
								<input id='enableWFfilter' type='radio' name='wfr_off' value=true checked onchange='updateADC.bind(this)()'></input>
								<label for='enableWFfilter'>Enabled</label>
								<input id='disableWFfilter' type='radio' name='wfr_off' value=false onchange='updateADC.bind(this)()'></input>
								<label for='disableWFfilter'>Disabled</label>
							</li>
						</ul>
					</div>

					<div id='simulation' class='collapse'>
						<h3 class='sectionHead' onclick='toggleSection.bind(this, "simulation")()'>&#9654 Simulation Pulse</h3>
						<ul>
							<li>
								<input id='enableSim' type='radio' name='sim_ena' value=true checked onchange='updateADC.bind(this)()'></input>
								<label for='enableSim'>Enabled</label>
								<input id='disableSim' type='radio' name='sim_ena' value=false onchange='updateADC.bind(this)()'></input>
								<label for='disableSim'>Disabled</label>
							</li>
							<li>
								<label>Pulse Height:</label>
								<input id='sim_phgt' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>Risetime:</label>
								<input id='sim_rise' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>Falltime:</label>
								<input id='sim_fall' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>Rate:</label>
								<input id='sim_rate' type='number' step='any' onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
							<li>
								<label>Period:</label>
								<input id='periodRand' type='radio' name='sim_rand' value=true checked onchange='updateADC.bind(this)()'></input>
								<label for='periodRand'>Random</label>
								<input id='periodFix' type='radio' name='sim_rand' value=false onchange='updateADC.bind(this)()'></input>
								<label for='periodFix'>Fixed</label>
							</li>
						</ul>
					</div>

					<div id='misc' class='collapse'>
						<h3 class='sectionHead' onclick='toggleSection.bind(this, "misc")()'>&#9654 Miscellaneous</h3>
						<ul>
							<li>
								<label>Fixed Deadtime:</label>
								<input id='fix_dead' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label>samples</label>
							</li>
							<li>
								<label>Detector Type:</label>
								<input id='det_type' type='number' step=1 onchange='updateADC.bind(this)()'></input>
								<label></label>
							</li>
						</ul>
					</div>

				</div>

				<div id='plotControl'>
					<label>y min [mV]</label>
					<input id='yMin' type='number' min=-1000 max=1000 value=-1000 step=1></input>
					<label>y max [mV]</label>
					<input id='yMax' type='number' min=-1000 max=1000 value=1000 step=1></input>
				</div>
			</div>


			<div id='push'></div>
		</div>

		<branding-foot></branding-foot>

		<script>
			document.addEventListener('DOMComponentsLoaded', function(){
				window.ADCparameters = [];

				cycleTo(0);
				fetchADC();
				populateStatusPane()

				window.onkeyup = keypress;

				window.mscbHost = 'http://mscb500.triumf.ca';

			});
		</script>

	</body>
</html>
